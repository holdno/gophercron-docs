import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.19f61efe.js";const A=JSON.parse('{"title":"Center Release Note","description":"","frontmatter":{},"headers":[],"relativePath":"note/center_release_note.md","filePath":"note/center_release_note.md"}'),p={name:"note/center_release_note.md"},o=l('<h1 id="center-release-note" tabindex="-1">Center Release Note <a class="header-anchor" href="#center-release-note" aria-label="Permalink to &quot;Center Release Note&quot;">​</a></h1><h2 id="v2-4-4" tabindex="-1">v2.4.4 <a class="header-anchor" href="#v2-4-4" aria-label="Permalink to &quot;v2.4.4&quot;">​</a></h2><p>2023-10-07</p><ul><li>调整 agent 注册数监控代码的位置</li><li>优化 agent 日志输出与采集代码</li></ul><h2 id="v2-4-3" tabindex="-1">v2.4.3 <a class="header-anchor" href="#v2-4-3" aria-label="Permalink to &quot;v2.4.3&quot;">​</a></h2><p>2023-09-17</p><ul><li>修复创建 webhook 的 store 实现问题，没有指定表名</li><li>调整 webhook 接口相关请求参数，types -&gt; type</li></ul><h4 id="升级-sql" tabindex="-1">升级 SQL <a class="header-anchor" href="#升级-sql" aria-label="Permalink to &quot;升级 SQL&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">ALTER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TABLE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`gc_webhook`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">DROP</span><span style="color:#E1E4E8;"> COLUMN </span><span style="color:#9ECBFF;">`secret`</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">ALTER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`gc_webhook`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">DROP</span><span style="color:#24292E;"> COLUMN </span><span style="color:#032F62;">`secret`</span><span style="color:#24292E;">;</span></span></code></pre></div><h2 id="v2-4-2" tabindex="-1">v2.4.2 <a class="header-anchor" href="#v2-4-2" aria-label="Permalink to &quot;v2.4.2&quot;">​</a></h2><p>2023-09-15</p><p>新增组织概念，组织仅作为项目的&quot;文件夹&quot;，更好的将项目进行归类<br> 用户无需特殊的邀请动作加入组织，直接赋予用户某个项目的权限时自动获取该组织的普通权限</p><h4 id="涉及改动" tabindex="-1">涉及改动 <a class="header-anchor" href="#涉及改动" aria-label="Permalink to &quot;涉及改动&quot;">​</a></h4><h5 id="新增数据表" tabindex="-1">新增数据表： <a class="header-anchor" href="#新增数据表" aria-label="Permalink to &quot;新增数据表：&quot;">​</a></h5><ul><li>增加组织表 org</li><li>增加组织用户关联表 org_relevance</li></ul><h5 id="接口变动" tabindex="-1">接口变动 <a class="header-anchor" href="#接口变动" aria-label="Permalink to &quot;接口变动&quot;">​</a></h5><ul><li>登录 <ul><li>/api/v1/user/login 接口响应数据增加用户拥有权限的组织列表 orgs</li></ul></li><li>日志 <ul><li>/api/v1/log/recent 接口增加请求参数 oid，表示对应组织信息</li><li>/api/v1/log/errors 接口增加请求参数 oid，表示对应组织信息</li></ul></li><li>项目 <ul><li>/api/v1/project/create 接口增加请求参数 oid，表示对应组织信息 <ul><li>验证用户是否属于对应组织</li></ul></li><li>/api/v1/project/add_user 项目增加用户接口，若用户之前未加入某组织，但现在加入了某组织的某个项目，则自动加入组织</li><li>/api/v1/project/list 获取项目列表现在是获取某个组织下的项目列表</li></ul></li><li>Workflow <ul><li>/api/v1/workflow/create 创建接口增加组织 id</li><li>/api/v1/workflow/list 获取 workflow 列表现在是获取某个组织下的 workflow 列表</li></ul></li><li>新增接口 <ul><li>/api/v1/org/create 创建组织接口</li><li>/api/v1/org/edit 编辑组织信息接口</li><li>/api/v1/org/delete 删除组织接口</li><li>/api/v1/org/list 获取用户组织列表接口</li></ul></li></ul><h5 id="sql" tabindex="-1">Sql <a class="header-anchor" href="#sql" aria-label="Permalink to &quot;Sql&quot;">​</a></h5><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"># project表增加oid字段</span></span>\n<span class="line"><span style="color:#F97583;">ALTER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TABLE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`gc_project`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ADD</span><span style="color:#E1E4E8;"> COLUMN </span><span style="color:#9ECBFF;">`oid`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">varchar</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">32</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> COMMENT </span><span style="color:#9ECBFF;">&#39;关联组织id&#39;</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;"># 刷新旧项目所属组织为baseorg，即通用组织</span></span>\n<span class="line"><span style="color:#F97583;">update</span><span style="color:#E1E4E8;"> gc_project </span><span style="color:#F97583;">set</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;baseorg&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">where</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;"># 用户项目关联关系表中增加role字段</span></span>\n<span class="line"><span style="color:#F97583;">ALTER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TABLE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`gc_project_relevance`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ADD</span><span style="color:#E1E4E8;"> COLUMN </span><span style="color:#9ECBFF;">`role`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">varchar</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">32</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">DEFAULT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#E1E4E8;"> COMMENT </span><span style="color:#9ECBFF;">&#39;用户基于项目的角色&#39;</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;"># 刷新旧项目成员project </span><span style="color:#F97583;">role</span></span>\n<span class="line"><span style="color:#F97583;">update</span><span style="color:#E1E4E8;"> gc_project_relevance </span><span style="color:#F97583;">set</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">role</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;manager&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">where</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">role</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;"># workflow表增加oid字段</span></span>\n<span class="line"><span style="color:#F97583;">ALTER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TABLE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`gc_workflow`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ADD</span><span style="color:#E1E4E8;"> COLUMN </span><span style="color:#9ECBFF;">`oid`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">varchar</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">32</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">DEFAULT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#E1E4E8;"> COMMENT </span><span style="color:#9ECBFF;">&#39;关联组织id&#39;</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;"># 刷新旧workflow所属组织为baseorg</span></span>\n<span class="line"><span style="color:#F97583;">update</span><span style="color:#E1E4E8;"> gc_workflow </span><span style="color:#F97583;">set</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;baseorg&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">where</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;&#39;</span><span style="color:#E1E4E8;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;"># 新增org组织信息表</span></span>\n<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TABLE</span><span style="color:#E1E4E8;"> `</span><span style="color:#B392F0;">gc_org</span><span style="color:#E1E4E8;">` (</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">`id`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">varchar</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">32</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> COMMENT </span><span style="color:#9ECBFF;">&#39;组织id&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">`title`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">varchar</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">32</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> COMMENT </span><span style="color:#9ECBFF;">&#39;组织名称&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">`create_time`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">bigint</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> COMMENT </span><span style="color:#9ECBFF;">&#39;创建时间&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">PRIMARY KEY</span><span style="color:#E1E4E8;"> (</span><span style="color:#9ECBFF;">`id`</span><span style="color:#E1E4E8;">)) ENGINE </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> InnoDB </span><span style="color:#F97583;">DEFAULT</span><span style="color:#E1E4E8;"> CHARSET </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> utf8mb4;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;"># 新增org_relevance用户组织关系表</span></span>\n<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TABLE</span><span style="color:#E1E4E8;"> `</span><span style="color:#B392F0;">gc_org_relevance</span><span style="color:#E1E4E8;">` (</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">`id`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">bigint</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> AUTO_INCREMENT,</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">`uid`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">bigint</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> COMMENT </span><span style="color:#9ECBFF;">&#39;关联用户id&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">`oid`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">varchar</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">32</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> COMMENT </span><span style="color:#9ECBFF;">&#39;关联组织id&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">`role`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">varchar</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">32</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">DEFAULT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;user&#39;</span><span style="color:#E1E4E8;"> COMMENT </span><span style="color:#9ECBFF;">&#39;项目角色&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">`create_time`</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">bigint</span><span style="color:#E1E4E8;"> (</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;"> COMMENT </span><span style="color:#9ECBFF;">&#39;创建时间&#39;</span><span style="color:#E1E4E8;">,</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">PRIMARY KEY</span><span style="color:#E1E4E8;"> (</span><span style="color:#9ECBFF;">`id`</span><span style="color:#E1E4E8;">),</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">KEY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`uid`</span><span style="color:#E1E4E8;"> (</span><span style="color:#9ECBFF;">`uid`</span><span style="color:#E1E4E8;">),</span></span>\n<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#F97583;">KEY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`oid`</span><span style="color:#E1E4E8;"> (</span><span style="color:#9ECBFF;">`oid`</span><span style="color:#E1E4E8;">)) ENGINE </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> InnoDB </span><span style="color:#F97583;">DEFAULT</span><span style="color:#E1E4E8;"> CHARSET </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> utf8mb4;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#E1E4E8;"># 将原用户加入某个组织</span></span>\n<span class="line"><span style="color:#F97583;">INSERT INTO</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`gc_org_relevance`</span><span style="color:#E1E4E8;"> (</span><span style="color:#9ECBFF;">`uid`</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">`oid`</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">`role`</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">`create_time`</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">`id`</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;{组织id}&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;user&#39;</span><span style="color:#E1E4E8;">, UNIX_TIMESTAMP(</span><span style="color:#F97583;">NOW</span><span style="color:#E1E4E8;">()) </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> gc_user;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"># project表增加oid字段</span></span>\n<span class="line"><span style="color:#D73A49;">ALTER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`gc_project`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ADD</span><span style="color:#24292E;"> COLUMN </span><span style="color:#032F62;">`oid`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">32</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> COMMENT </span><span style="color:#032F62;">&#39;关联组织id&#39;</span><span style="color:#24292E;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;"># 刷新旧项目所属组织为baseorg，即通用组织</span></span>\n<span class="line"><span style="color:#D73A49;">update</span><span style="color:#24292E;"> gc_project </span><span style="color:#D73A49;">set</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;baseorg&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">where</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#24292E;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;"># 用户项目关联关系表中增加role字段</span></span>\n<span class="line"><span style="color:#D73A49;">ALTER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`gc_project_relevance`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ADD</span><span style="color:#24292E;"> COLUMN </span><span style="color:#032F62;">`role`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">32</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">DEFAULT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#24292E;"> COMMENT </span><span style="color:#032F62;">&#39;用户基于项目的角色&#39;</span><span style="color:#24292E;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;"># 刷新旧项目成员project </span><span style="color:#D73A49;">role</span></span>\n<span class="line"><span style="color:#D73A49;">update</span><span style="color:#24292E;"> gc_project_relevance </span><span style="color:#D73A49;">set</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">role</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;manager&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">where</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">role</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#24292E;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;"># workflow表增加oid字段</span></span>\n<span class="line"><span style="color:#D73A49;">ALTER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`gc_workflow`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ADD</span><span style="color:#24292E;"> COLUMN </span><span style="color:#032F62;">`oid`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">32</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">DEFAULT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#24292E;"> COMMENT </span><span style="color:#032F62;">&#39;关联组织id&#39;</span><span style="color:#24292E;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;"># 刷新旧workflow所属组织为baseorg</span></span>\n<span class="line"><span style="color:#D73A49;">update</span><span style="color:#24292E;"> gc_workflow </span><span style="color:#D73A49;">set</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;baseorg&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">where</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;&#39;</span><span style="color:#24292E;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;"># 新增org组织信息表</span></span>\n<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#24292E;"> `</span><span style="color:#6F42C1;">gc_org</span><span style="color:#24292E;">` (</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#032F62;">`id`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">32</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> COMMENT </span><span style="color:#032F62;">&#39;组织id&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#032F62;">`title`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">32</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> COMMENT </span><span style="color:#032F62;">&#39;组织名称&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#032F62;">`create_time`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">bigint</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">20</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> COMMENT </span><span style="color:#032F62;">&#39;创建时间&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">PRIMARY KEY</span><span style="color:#24292E;"> (</span><span style="color:#032F62;">`id`</span><span style="color:#24292E;">)) ENGINE </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> InnoDB </span><span style="color:#D73A49;">DEFAULT</span><span style="color:#24292E;"> CHARSET </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> utf8mb4;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;"># 新增org_relevance用户组织关系表</span></span>\n<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#24292E;"> `</span><span style="color:#6F42C1;">gc_org_relevance</span><span style="color:#24292E;">` (</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#032F62;">`id`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">bigint</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">20</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> AUTO_INCREMENT,</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#032F62;">`uid`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">bigint</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">20</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> COMMENT </span><span style="color:#032F62;">&#39;关联用户id&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#032F62;">`oid`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">32</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> COMMENT </span><span style="color:#032F62;">&#39;关联组织id&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#032F62;">`role`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">varchar</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">32</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">DEFAULT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;user&#39;</span><span style="color:#24292E;"> COMMENT </span><span style="color:#032F62;">&#39;项目角色&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#032F62;">`create_time`</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">bigint</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">20</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">NOT NULL</span><span style="color:#24292E;"> COMMENT </span><span style="color:#032F62;">&#39;创建时间&#39;</span><span style="color:#24292E;">,</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">PRIMARY KEY</span><span style="color:#24292E;"> (</span><span style="color:#032F62;">`id`</span><span style="color:#24292E;">),</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">KEY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`uid`</span><span style="color:#24292E;"> (</span><span style="color:#032F62;">`uid`</span><span style="color:#24292E;">),</span></span>\n<span class="line"><span style="color:#24292E;">	</span><span style="color:#D73A49;">KEY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`oid`</span><span style="color:#24292E;"> (</span><span style="color:#032F62;">`oid`</span><span style="color:#24292E;">)) ENGINE </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> InnoDB </span><span style="color:#D73A49;">DEFAULT</span><span style="color:#24292E;"> CHARSET </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> utf8mb4;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#24292E;"># 将原用户加入某个组织</span></span>\n<span class="line"><span style="color:#D73A49;">INSERT INTO</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`gc_org_relevance`</span><span style="color:#24292E;"> (</span><span style="color:#032F62;">`uid`</span><span style="color:#24292E;">,</span><span style="color:#032F62;">`oid`</span><span style="color:#24292E;">,</span><span style="color:#032F62;">`role`</span><span style="color:#24292E;">,</span><span style="color:#032F62;">`create_time`</span><span style="color:#24292E;">) </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">`id`</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;{组织id}&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;user&#39;</span><span style="color:#24292E;">, UNIX_TIMESTAMP(</span><span style="color:#D73A49;">NOW</span><span style="color:#24292E;">()) </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> gc_user;</span></span></code></pre></div><h2 id="v2-3-0-alpha-1" tabindex="-1">v2.3.0-alpha.1 <a class="header-anchor" href="#v2-3-0-alpha-1" aria-label="Permalink to &quot;v2.3.0-alpha.1&quot;">​</a></h2><p>支持直接通过边缘与中心建立的 stream 调用任务，既内网 agent 也可以实现由人工在中心进行调度执行。</p>',21),e=[o];function r(c,t,E,y,i,F){return a(),n("div",null,e)}const C=s(p,[["render",r]]);export{A as __pageData,C as default};
