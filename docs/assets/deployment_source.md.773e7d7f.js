import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.19f61efe.js";const F=JSON.parse('{"title":"源码部署","description":"","frontmatter":{},"headers":[],"relativePath":"deployment/source.md","filePath":"deployment/source.md"}'),o={name:"deployment/source.md"},p=l(`<h1 id="源码部署" tabindex="-1">源码部署 <a class="header-anchor" href="#源码部署" aria-label="Permalink to &quot;源码部署&quot;">​</a></h1><h2 id="构建" tabindex="-1">构建 <a class="header-anchor" href="#构建" aria-label="Permalink to &quot;构建&quot;">​</a></h2><p>(目前时间有限，还没实现每次更新自动 build 出各架构下的二进制...，用户可以自行克隆仓库进行构建)</p><h3 id="amd64" tabindex="-1">amd64 <a class="header-anchor" href="#amd64" aria-label="Permalink to &quot;amd64&quot;">​</a></h3><p>可以从镜像中 copy 出二进制文件实现部署</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#!/bin/sh</span></span>
<span class="line"><span style="color:#E1E4E8;">NAME</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;gophercron_cp_binary&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">VERSION</span><span style="color:#F97583;">=</span><span style="color:#FFAB70;">$1</span></span>
<span class="line"><span style="color:#E1E4E8;">IMAGE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;holdnowby/gophercron&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pull</span><span style="color:#E1E4E8;"> \${IMAGE}</span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;">\${VERSION}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--name</span><span style="color:#E1E4E8;"> \${NAME} </span><span style="color:#79B8FF;">-itd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--rm</span><span style="color:#E1E4E8;"> \${IMAGE}</span><span style="color:#9ECBFF;">:</span><span style="color:#E1E4E8;">\${VERSION} </span><span style="color:#9ECBFF;">/bin/sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cp</span><span style="color:#E1E4E8;"> \${NAME}</span><span style="color:#9ECBFF;">:/gophercron/gophercron</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./gophercron</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kill</span><span style="color:#E1E4E8;"> \${NAME}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#!/bin/sh</span></span>
<span class="line"><span style="color:#24292E;">NAME</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;gophercron_cp_binary&quot;</span></span>
<span class="line"><span style="color:#24292E;">VERSION</span><span style="color:#D73A49;">=</span><span style="color:#E36209;">$1</span></span>
<span class="line"><span style="color:#24292E;">IMAGE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;holdnowby/gophercron&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pull</span><span style="color:#24292E;"> \${IMAGE}</span><span style="color:#032F62;">:</span><span style="color:#24292E;">\${VERSION}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--name</span><span style="color:#24292E;"> \${NAME} </span><span style="color:#005CC5;">-itd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--rm</span><span style="color:#24292E;"> \${IMAGE}</span><span style="color:#032F62;">:</span><span style="color:#24292E;">\${VERSION} </span><span style="color:#032F62;">/bin/sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cp</span><span style="color:#24292E;"> \${NAME}</span><span style="color:#032F62;">:/gophercron/gophercron</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./gophercron</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kill</span><span style="color:#24292E;"> \${NAME}</span></span></code></pre></div><h2 id="部署" tabindex="-1">部署 <a class="header-anchor" href="#部署" aria-label="Permalink to &quot;部署&quot;">​</a></h2><h3 id="中心服务" tabindex="-1">中心服务 <a class="header-anchor" href="#中心服务" aria-label="Permalink to &quot;中心服务&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">./gophercron</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">service</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-c</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">{your</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">service</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">config}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">./gophercron</span><span style="color:#24292E;"> </span><span style="color:#032F62;">service</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-c</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{your</span><span style="color:#24292E;"> </span><span style="color:#032F62;">service</span><span style="color:#24292E;"> </span><span style="color:#032F62;">config}</span></span></code></pre></div><h3 id="agent" tabindex="-1">Agent <a class="header-anchor" href="#agent" aria-label="Permalink to &quot;Agent&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">./gophercron</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">client</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-c</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">{your</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">client</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">config}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">./gophercron</span><span style="color:#24292E;"> </span><span style="color:#032F62;">client</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-c</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{your</span><span style="color:#24292E;"> </span><span style="color:#032F62;">client</span><span style="color:#24292E;"> </span><span style="color:#032F62;">config}</span></span></code></pre></div><h3 id="systemd" tabindex="-1">systemd <a class="header-anchor" href="#systemd" aria-label="Permalink to &quot;systemd&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;[Unit]</span></span>
<span class="line"><span style="color:#9ECBFF;">Description=GopherCron</span></span>
<span class="line"><span style="color:#9ECBFF;">After=network.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">[Service]</span></span>
<span class="line"><span style="color:#9ECBFF;">Type=simple</span></span>
<span class="line"><span style="color:#9ECBFF;">WorkingDirectory=/usr/local/bin</span></span>
<span class="line"><span style="color:#9ECBFF;">ExecStart=/usr/bin/sh -c &#39;/usr/local/bin/gophercron {client / service} -c /usr/local/etc/gophercron/{your config name}.toml&#39;</span></span>
<span class="line"><span style="color:#9ECBFF;">Restart=always&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/systemd/system/gophercron.service</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;[Unit]</span></span>
<span class="line"><span style="color:#032F62;">Description=GopherCron</span></span>
<span class="line"><span style="color:#032F62;">After=network.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">[Service]</span></span>
<span class="line"><span style="color:#032F62;">Type=simple</span></span>
<span class="line"><span style="color:#032F62;">WorkingDirectory=/usr/local/bin</span></span>
<span class="line"><span style="color:#032F62;">ExecStart=/usr/bin/sh -c &#39;/usr/local/bin/gophercron {client / service} -c /usr/local/etc/gophercron/{your config name}.toml&#39;</span></span>
<span class="line"><span style="color:#032F62;">Restart=always&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/systemd/system/gophercron.service</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">enable</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gophercron.service</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">enable</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gophercron.service</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">start</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gophercron.service</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">start</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gophercron.service</span></span></code></pre></div>`,15),e=[p];function c(t,r,i,y,E,d){return a(),n("div",null,e)}const u=s(o,[["render",c]]);export{F as __pageData,u as default};
